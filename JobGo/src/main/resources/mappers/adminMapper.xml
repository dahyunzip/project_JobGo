<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.itwillbs.mapper.adminMapper">
	
	<!-- 일반회원 목록 -->
	<select id="getAllNormalMembers" resultType="com.itwillbs.domain.MemberVO">
		select 
			id,
			userid,
			name,
			email,
			phone,
			membertype,
			is_deleted as isDeleted
		from member
		order by id desc
		limit #{pageStart}, #{pageSize}
	</select>

	<select id="getNormalMemberTotalCount" resultType="int">
		select count(*) from member
	</select>

	<!-- 기업회원 목록 -->
	<select id="getAllCorpMembers" resultType="com.itwillbs.domain.CorpMemberVO">
		select
			corp_id              as corpId,
			corp_userid          as corpUserId,
			corp_userpw          as corpUserPw,
			manager_name         as managerName,
			manager_email        as managerEmail,
			manager_tel          as managerTel,
			company_name         as companyName,
			business_rno         as businessRno,
			business_licenseurl  as businessLicenseUrl,
			ceo_name             as ceoName,
			company_address      as companyAddress,
			industry_type        as industryType,
			business_type        as businessType,
			corp_joined          as corpJoined,
			corp_updated         as corpUpdated,
			status               as status,
			corp_checkdeleted    as corpCheckDeleted
		from corpmember
		order by corp_id desc
		limit #{pageStart}, #{pageSize}
	</select>

	<select id="getCorpMemberTotalCount" resultType="int">
		select count(*) from corpmember
	</select>
	
	<!-- 기업회원 승인 -->
	<update id="approveCorp" parameterType="int">
		update corpmember
		set status = 'A'
		where corp_id = #{corpId}
	</update>
	
	<!-- 기업회원 거절 -->
	<update id="denyCorp" parameterType="int">
		update corpmember
		set status = 'D'
		where corp_id = #{corpId}
	</update>

	<!-- 회원 삭제 -->
	<delete id="deleteMember" parameterType="int">
		delete from member where id = #{id}
	</delete>

	<!-- 리뷰 목록 조회 -->
	<select id="getAllReviews" resultType="com.itwillbs.domain.ReviewVO">
		select 
	        review_id     as reviewId,
	        member_id     as memberId,
	        corp_id       as corpId,
	        job_code      as jobCode,
	        rev_title     as revTitle,
	        rev_content   as revContent,
	        rev_rate      as revRate,
	        rev_public    as revPublic,
	        rev_regdate   as revRegdate,
	        rev_updatedate as revUpdatedate
	    from review
	    order by review_id desc
	    limit #{pageStart}, #{pageSize}
	</select>

	<select id="getReviewTotalCount" resultType="int">
		select count(*) from review
	</select>

	<!-- 리뷰 삭제 -->
	<delete id="deleteReview" parameterType="int">
		delete from review where review_id = #{reviewId}
	</delete>
	

</mapper>